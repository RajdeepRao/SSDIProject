var app = angular.module("myApp",["ngRoute"]);

app.config(function($routeProvider){
  $routeProvider
  .when('/',{
    templateUrl:'landingPage.html'
  })
  .when('/dashboard',{
    resolve: {
      "check": function($location,$rootScope){
          if(!$rootScope.logIn){
            $location.path('/');
          }
      }
    },
    templateUrl:'dashboard.html'
  })
  .otherwise({
    redirectTo: '/'
  })
});

app.controller('LogIn',function($scope,$rootScope, $location){
  $scope.email="rajdeeprrao94@gmail.com";
  $scope.password="asdf";
  $scope.username="";
  $rootScope.logIn=false;

  $scope.logIn=function(email){
    if(email=="rajdeeprrao94@gmail.com"){
        $rootScope.logIn=true;
        alert('login successful');
        getElementById('myModal').modal('hide');
    }

  };

});

app.controller('SignUp',function($scope, $http, $rootScope, $location){
	
  $scope.role;
  $scope.firstName;
  $scope.lastName;
  $scope.ninerNumber;
  $scope.email;
  $scope.password;
  $scope.value=5;
  $scope.students;

  $rootScope.signUpSuccess=false;

  
  $scope.signUpFunction=function(){
	  $scope.value=5+$scope.ninerNumber;
	  
	  $http.get('http://localhost:8080/students')
	  .success(function(response){
	    //$scope.students=response.students;
		 data=JSON.stringify(response);
		 console.log(data);
	    
		 var jsonObj=JSON.parse(data);
		 console.log(jsonObj[0]);
	  });
	  //"id":1,"firstName":"Vinay","lastName":"Subramanian","emailId":"vinays@uncc.edu","password":"vinay1994"
	  var dataObj = {
				id : $scope.ninerNumber,
				firstName : $scope.firstName,
				lastName : $scope.lastName,
				emailId : $scope.email,
				password : $scope.password
		};	
	  var dataJsonObj=JSON.parse(dataObj);
		var res = $http.put('http://localhost:8080/students/6', dataJsonObj);
		res.success(function(data, status, headers, config) {
			$scope.message = data;
		});
		res.error(function(data, status, headers, config) {
			alert( "failure message: " + JSON.stringify({data: data}));
		});	
	   
  };


});

app.controller('listStudents',function($scope,$http){
  $http.get('http://localhost:8080/data2.json')
  .success(function(response){
    //$scope.students=response.students;
	 data=JSON.stringify(response);
	 console.log(data);
    
	 var jsonObj=JSON.parse(data);
	 console.log(jsonObj[0]);
  });
});
